import json
import boto3
import decimal
from datetime import date
from datetime import timedelta
from boto3.dynamodb.conditions import Key, Attr

cameras = [
           "D42122A8D7AE"
          ]  
def lambda_handler(event, context):
    client = boto3.resource('dynamodb') 
    table = client.Table('ObjectDetectionForETL')
    destTable = client.Table('ObjectDetectionForETLTestCameras')
    currentDate = date.today()
    for day in range (0, 10):
        for camera in cameras:
            key = camera+'-'+ currentDate.strftime ("%m%d%Y")
            print('key=', key)
            response = table.query(KeyConditionExpression=Key('macpartition').eq(key))
            for item in response[u'Items']:
                destTable.put_item(Item = item)
        currentDate = currentDate - timedelta(days = 1) 